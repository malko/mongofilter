/*https://github.com/malko/mongofilter brought to you under MIT licence by Jonathan Gotti version: 1.0.1*/
!function(n,e){if("function"==typeof define&&define.amd)define(["exports","module"],e);else if("undefined"!=typeof exports&&"undefined"!=typeof module)e(exports,module);else{var t={exports:{}};e(t.exports,t),n.mongofilter=t.exports}}(this,function(n,e){"use strict";function t(n,e,t,r){var i=[];return Array.isArray(e)?e.forEach(function(e,t){return i.push(new o(e,t,r).filterItem(n))}):Object.keys(e).forEach(function(t){return i.push(new o(e[t],t,r).filterItem(n))}),i="OR"===t?!!~i.indexOf(!0):"NOR"===t?!~i.indexOf(!0):!~i.indexOf(!1)}function r(n,e,t){var r=!0;return r=(typeof e).match(/string|number|boolean/)?a["="](n[t],e):e instanceof Array?a.IN(n[t],e):new o(e,"AND",t).filterItem(n)}function i(n,e,i,o){return i in a?a[i](n[o],e):"AND"===i||"NOR"===i||"OR"===i?t(n,e,i,o):r(n,e,i)}function o(n){var e=void 0===arguments[1]?"AND":arguments[1],t=void 0===arguments[2]?null:arguments[2];s[e]&&(e=s[e]),this.filterItem=function(r){if("string"==typeof r)try{r=JSON.parse(r)}catch(o){return!1}return i(r,n,e,t)}}function f(n){if("string"==typeof n&&(n=JSON.parse(n)),!n)throw"Invalid clause";var e=new o(n),t=function(n){return e.filterItem(n)};return t.filter=e.filterCollection,t.filterItem=e.filterItem,t}e.exports=f;var u=/(^|[^%])%(?!%)/g,c=/(^|[^\\])(_+)/g,l=function(n,e,t){return e+new Array(t.length+1).join(".")},a={">":function(n,e){return n>e},">=":function(n,e){return n>=e},"<":function(n,e){return e>n},"<=":function(n,e){return e>=n},"=":function(n,e){return n===e},"!=":function(n,e){return n!==e},REGEX:function(n,e){return"string"==typeof e&&!function(){var n=void 0,t=void 0;e.replace(/^\/([\s\S]*)\/([igm])?/,function(e,r,i){t=r,n=i}),t||(t=e),e=n?new RegExp(t,n):new RegExp(t)}(),!!n.match(e)},LIKE:function(n,e){var t=new RegExp("^"+e.replace(u,"$1.*").replace(c,l)+"$");return!(!n&&0!==n||!n.toString().match(t))},UNLIKE:function(n,e){return!a.LIKE(n,e)},IN:function(n,e){return!!~e.indexOf(n)},NOTIN:function(n,e){return!~e.indexOf(n)}},s={$gt:">",$gte:">=",$lt:"<",$lte:"<=",$or:"OR","||":"OR",$nor:"NOR",$and:"AND","&&":"AND",$e:"=",$eq:"=","<>":"!=",$ne:"!=","!e":"!=",$in:"IN","!in":"NOTIN",$nin:"NOTIN","NOT IN":"NOTIN",$regex:"REGEX",$like:"LIKE",$nlike:"UNLIKE","!like":"UNLIKE","NOT LIKE":"UNLIKE"};o.prototype.filterCollection=function(n){return n?n.filter(this.filterItem):[]},f.comparators=a});
