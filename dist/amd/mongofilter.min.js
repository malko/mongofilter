/*https://github.com/malko/mongofilter brought to you under MIT licence by Jonathan Gotti version: 1.0.2*/
define("mongofilter",["exports","module"],function(n,t){"use strict";function e(n,t,e,r){var i=[];return Array.isArray(t)?t.forEach(function(t,e){return i.push(new u(t,e,r).filterItem(n))}):Object.keys(t).forEach(function(e){return i.push(new u(t[e],e,r).filterItem(n))}),i="OR"===e?!!~i.indexOf(!0):"NOR"===e?!~i.indexOf(!0):!~i.indexOf(!1)}function r(n,t,e){var r=!0;return r=(typeof t).match(/string|number|boolean/)?l["="](n[e],t):t instanceof Array?l.IN(n[e],t):new u(t,"AND",e).filterItem(n)}function i(n,t,i,u){return i in l?l[i](n[u],t):"AND"===i||"NOR"===i||"OR"===i?e(n,t,i,u):r(n,t,i)}function u(n){var t=void 0===arguments[1]?"AND":arguments[1],e=void 0===arguments[2]?null:arguments[2];N[t]&&(t=N[t]),this.filterItem=function(r){if("string"==typeof r)try{r=JSON.parse(r)}catch(u){return!1}return i(r,n,t,e)}}function o(n){if("string"==typeof n&&(n=JSON.parse(n)),!n)throw"Invalid clause";var t=new u(n),e=function(n){return t.filterItem(n)};return e.filter=t.filterCollection,e.filterItem=t.filterItem,e}t.exports=o;var f=/(^|[^%])%(?!%)/g,c=/(^|[^\\])(_+)/g,a=function(n,t,e){return t+new Array(e.length+1).join(".")},l={">":function(n,t){return n>t},">=":function(n,t){return n>=t},"<":function(n,t){return t>n},"<=":function(n,t){return t>=n},"=":function(n,t){return n===t},"!=":function(n,t){return n!==t},REGEX:function(n,t){return"string"==typeof t&&!function(){var n=void 0,e=void 0;t.replace(/^\/([\s\S]*)\/([igm])?/,function(t,r,i){e=r,n=i}),e||(e=t),t=n?new RegExp(e,n):new RegExp(e)}(),!!n.match(t)},LIKE:function(n,t){var e=new RegExp("^"+t.replace(f,"$1.*").replace(c,a)+"$");return!(!n&&0!==n||!n.toString().match(e))},UNLIKE:function(n,t){return!l.LIKE(n,t)},IN:function(n,t){return!!~t.indexOf(n)},NOTIN:function(n,t){return!~t.indexOf(n)}},N={$gt:">",$gte:">=",$lt:"<",$lte:"<=",$or:"OR","||":"OR",$nor:"NOR",$and:"AND","&&":"AND",$e:"=",$eq:"=","<>":"!=",$ne:"!=","!e":"!=",$in:"IN","!in":"NOTIN",$nin:"NOTIN","NOT IN":"NOTIN",$regex:"REGEX",$like:"LIKE",$nlike:"UNLIKE","!like":"UNLIKE","NOT LIKE":"UNLIKE"};u.prototype.filterCollection=function(n){return n?n.filter(this.filterItem):[]},o.comparators=l});
